<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>领主装备 | 升级计算页面</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --muted: #9ca3af;
      --fg: #e5e7eb;
      --accent: #f59e0b;
      --accent-2: #22d3ee;
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color: var(--fg); background: linear-gradient(180deg, #0b1023 0%, #0f172a 100%); min-height: 100vh; }
    header { position: sticky; top: 0; z-index: 10; background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(8px); border-bottom: 1px solid var(--border); }
    h1 { text-align: center; font-size: 32px; margin: 16px 0 8px; letter-spacing: 2px; }
    nav { display: flex; justify-content: center; gap: 16px; padding: 8px 0 16px; }
    nav a { color: #7dd3fc; font-weight: 600; text-decoration: none; }
    nav a:hover { text-decoration: underline; }

    .container { max-width: 1180px; margin: 0 auto; padding: 16px 20px; display: grid; grid-template-columns: 1fr 320px; gap: 20px; }
    @media (max-width: 960px) { .container { grid-template-columns: 1fr; } .aside { position: static; } }

    .card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; }
    .table-wrap { overflow: auto; border-radius: 14px; }
    table { width: 100%; border-collapse: collapse; }
    thead th { position: sticky; top: 0; background: #0b1224; }
    th, td { padding: 12px 10px; text-align: center; border-bottom: 1px solid var(--border); }
    tbody tr:hover { background: rgba(34, 211, 238, 0.06); }

    .aside { position: sticky; top: 72px; align-self: start; }
    .panel { padding: 16px; }
    .panel h2 { font-size: 20px; margin: 0 0 12px; }
    .field { display: grid; grid-template-columns: 110px 1fr; align-items: center; gap: 10px; margin: 10px 0; }
    select, input[type="number"] { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border); background: #0b1023; color: var(--fg); }
    .btn { width: 100%; margin-top: 8px; padding: 12px 14px; border-radius: 12px; border: 1px solid transparent; color: white; font-weight: 700; cursor: pointer; background: linear-gradient(90deg, var(--accent) 0%, #ef4444 40%, var(--accent-2) 100%); }
    .btn:hover { filter: brightness(1.05); }
    .result { margin-top: 14px; padding: 12px; border: 1px dashed var(--border); border-radius: 12px; background: #0b1023; }
    .muted { color: var(--muted); font-size: 13px; }
    #old-calc-panel {
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>领主装备</h1>
    <nav>
      <a href="index.html">领主宝石</a>
      <a href="lord-gear.html">当前页：领主装备</a>
      <a href="fc.html">火晶升级</a>
      <a href="pet.html">宠物升级</a>
    </nav>
  </header>

  <main class="container">
    <section class="card table-wrap" aria-label="装备表格">
      <table id="equip-table">
        <thead>
          <tr>
            <!-- <th>编号</th> -->
            <th>等阶</th>
            <th>合金</th>
            <th>抛光液</th>
            <th>卷轴</th>
            <th>月光石</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <aside class="aside card">
      <div class="panel" id="old-calc-panel">
        <h2>升级计算机</h2>
        <div class="field">
          <label for="start">起始编号：</label>
          <select id="start"></select>
        </div>
        <div class="field">
          <label for="end">最终编号：</label>
          <select id="end"></select>
        </div>
        <div class="field">
          <label for="count">件数：</label>
          <input id="count" type="number" min="1" step="1" value="1" />
        </div>
        <button id="calc" class="btn">计算</button>
        <div class="result" id="result">
          <div class="muted">请选择等级并输入件数后点击“计算”。</div>
        </div>
      </div>

      <div class="panel">
        <h2>材料计算器</h2>

        <div class="field">
          <label for="acc-start">起始等级：</label>
          <select id="acc-start"></select>
        </div>

        <div class="field">
          <label for="acc-end">最终等级：</label>
          <select id="acc-end"></select>
        </div>

        <div class="field">
          <label for="acc-count">件数：</label>
          <input id="acc-count" type="number" min="1" value="1">
        </div>

        <button id="acc-add" class="btn">添加</button>

        <div id="acc-list" class="result" style="margin-top:12px;">
          <div class="muted">暂无记录</div>
        </div>

        <button id="acc-clear" class="btn" style="margin-top:12px;background:#ef4444;">
          清空
        </button>
      </div>
    </aside>
  </main>

  <!-- <footer style="text-align:center; color:#9ca3af; padding: 24px 0 40px;">
    页面由 GitHub Pages 托管 | 可与宝石页风格统一
  </footer> -->

  <script>
    // 1–42 级数据（来自你提供的图片）
    const rows = [
      { id: 1,  tier: '良好',        alloy: 1500,  polish: 15,   scroll: 0,   moon: 0 },
      { id: 2,  tier: '良好1星',      alloy: 3800,  polish: 40,   scroll: 0,   moon: 0 },
      { id: 3,  tier: '稀有',        alloy: 7000,  polish: 70,   scroll: 0,   moon: 0 },
      { id: 4,  tier: '稀有1星',      alloy: 9700,  polish: 95,   scroll: 0,   moon: 0 },
      { id: 5,  tier: '稀有2星',      alloy: 0,     polish: 0,    scroll: 45,  moon: 0 },
      { id: 6,  tier: '稀有3星',      alloy: 0,     polish: 0,    scroll: 50,  moon: 0 },
      { id: 7,  tier: '史诗',        alloy: 0,     polish: 0,    scroll: 60,  moon: 0 },
      { id: 8,  tier: '史诗1星',      alloy: 0,     polish: 0,    scroll: 70,  moon: 0 },
      { id: 9,  tier: '史诗2星',      alloy: 6500,  polish: 65,   scroll: 40,  moon: 0 },
      { id:10,  tier: '史诗3星',      alloy: 8000,  polish: 80,   scroll: 50,  moon: 0 },
      { id:11,  tier: '史诗T1',      alloy: 10000, polish: 95,   scroll: 60,  moon: 0 },
      { id:12,  tier: '史诗T1-1星',   alloy: 11000, polish: 110,  scroll: 70,  moon: 0 },
      { id:13,  tier: '史诗T1-2星',   alloy: 13000, polish: 130,  scroll: 85,  moon: 0 },
      { id:14,  tier: '史诗T1-3星',   alloy: 15000, polish: 160,  scroll: 100, moon: 0 },
      { id:15,  tier: '传说',        alloy: 22000, polish: 220,  scroll: 40,  moon: 0 },
      { id:16,  tier: '传说1星',      alloy: 23000, polish: 230,  scroll: 40,  moon: 0 },
      { id:17,  tier: '传说2星',      alloy: 25000, polish: 250,  scroll: 45,  moon: 0 },
      { id:18,  tier: '传说3星',      alloy: 26000, polish: 260,  scroll: 45,  moon: 0 },
      { id:19,  tier: '传说T1',      alloy: 28000, polish: 280,  scroll: 45,  moon: 0 },
      { id:20,  tier: '传说T1-1星',   alloy: 30000, polish: 300,  scroll: 55,  moon: 0 },
      { id:21,  tier: '传说T1-2星',   alloy: 32000, polish: 320,  scroll: 55,  moon: 0 },
      { id:22,  tier: '传说T1-3星',   alloy: 35000, polish: 340,  scroll: 55,  moon: 0 },
      { id:23,  tier: '传说T2',      alloy: 38000, polish: 360,  scroll: 55,  moon: 0 },
      { id:24,  tier: '传说T2-1星',   alloy: 43000, polish: 430,  scroll: 75,  moon: 0 },
      { id:25,  tier: '传说T2-2星',   alloy: 45000, polish: 460,  scroll: 80,  moon: 0 },
      { id:26,  tier: '传说T2-3星',   alloy: 48000, polish: 500,  scroll: 85,  moon: 0 },
      { id:27,  tier: '神话',        alloy: 50000, polish: 530,  scroll: 85,  moon: 10 },
      { id:28,  tier: '神话1星',      alloy: 52000, polish: 560,  scroll: 90,  moon: 10 },
      { id:29,  tier: '神话2星',      alloy: 54000, polish: 590,  scroll: 95,  moon: 10 },
      { id:30,  tier: '神话3星',      alloy: 56000, polish: 620,  scroll: 100, moon: 10 },
      { id:31,  tier: '神话T1',      alloy: 59000, polish: 670,  scroll: 110, moon: 15 },
      { id:32,  tier: '神话T1-1星',   alloy: 61000, polish: 700,  scroll: 115, moon: 15 },
      { id:33,  tier: '神话T1-2星',   alloy: 63000, polish: 730,  scroll: 120, moon: 15 },
      { id:34,  tier: '神话T1-3星',   alloy: 65000, polish: 760,  scroll: 125, moon: 15 },
      { id:35,  tier: '神话T2',      alloy: 68000, polish: 810,  scroll: 135, moon: 20 },
      { id:36,  tier: '神话T2-1星',   alloy: 70000, polish: 840,  scroll: 140, moon: 20 },
      { id:37,  tier: '神话T2-2星',   alloy: 72000, polish: 870,  scroll: 145, moon: 20 },
      { id:38,  tier: '神话T2-3星',   alloy: 74000, polish: 900,  scroll: 150, moon: 20 },
      { id:39,  tier: '神话T3',      alloy: 77000, polish: 950,  scroll: 160, moon: 25 },
      { id:40,  tier: '神话T3-1星',   alloy: 80000, polish: 990,  scroll: 165, moon: 25 },
      { id:41,  tier: '神话T3-2星',   alloy: 83000, polish: 1030, scroll: 170, moon: 25 },
      { id:42,  tier: '神话T3-3星',   alloy: 86000, polish: 1070, scroll: 180, moon: 25 },
      { id: 43, tier: '神话T4',     alloy: 120000, polish: 1500, scroll: 250, moon: 40 },
      { id: 44, tier: '神话T4-1星', alloy: 140000, polish: 1650, scroll: 275, moon: 40 },
      { id: 45, tier: '神话T4-2星', alloy: 160000, polish: 1800, scroll: 300, moon: 40 },
      { id: 46, tier: '神话T4-3星', alloy: 180000, polish: 1950, scroll: 325, moon: 40 },
          ];

    // 渲染表格
    const tbody = document.querySelector('#equip-table tbody');
    rows.forEach(r => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${r.tier}</td><td>${r.alloy}</td><td>${r.polish}</td><td>${r.scroll}</td><td>${r.moon}</td>`;
      tbody.appendChild(tr);
    });

    // 填充下拉
    const startSel = document.querySelector('#start');
    const endSel = document.querySelector('#end');
    rows.forEach(r => {
      const o1 = document.createElement('option'); o1.value = r.id; o1.textContent = r.id; startSel.appendChild(o1);
      const o2 = document.createElement('option'); o2.value = r.id; o2.textContent = r.id; endSel.appendChild(o2);
    });
    startSel.value = 1; endSel.value = 1;

    // 计算
    function fmt(n){ return n.toLocaleString('zh-Hans-CN'); }
    function calc(){
      const s = parseInt(startSel.value, 10);
      const e = parseInt(endSel.value, 10);
      const c = Math.max(1, parseInt(document.querySelector('#count').value || '1', 10));
      if(e < s){
        document.querySelector('#result').innerHTML = '<span class="muted">最终编号不能小于起始编号。</span>';
        return;
      }
      let alloy=0, polish=0, scroll=0, moon=0;
      for(const r of rows){
        if(r.id>=s && r.id<=e){ alloy+=r.alloy; polish+=r.polish; scroll+=r.scroll; moon+=r.moon; }
      }
      alloy*=c; polish*=c; scroll*=c; moon*=c;
      document.querySelector('#result').innerHTML = `
        <div>合金：<strong>${fmt(alloy)}</strong></div>
        <div>抛光液：<strong>${fmt(polish)}</strong></div>
        <div>卷轴：<strong>${fmt(scroll)}</strong></div>
        <div>月光石：<strong>${fmt(moon)}</strong></div>
        <div class="muted" style="margin-top:8px;">区间：${s} → ${e}，件数：${c}</div>
      `;
    }
    document.querySelector('#calc').addEventListener('click', calc);
    /* =============================
       ✨ 区间累加计算器（核心功能）
       ============================= */

       const accStart = document.querySelector('#acc-start');
    const accEnd   = document.querySelector('#acc-end');

    /* 填充累加计算器下拉 */
    rows.forEach(r => {
      const o1 = document.createElement('option'); o1.value = r.id; o1.textContent = r.tier; accStart.appendChild(o1);
      const o2 = document.createElement('option'); o2.value = r.id; o2.textContent = r.tier; accEnd.appendChild(o2);
    });

    accStart.value = 1;
    accEnd.value = 1;

    let accList = []; // 保存多个区间记录

    function renderAccList() {
      const box = document.querySelector('#acc-list');

      if (accList.length === 0) {
        box.innerHTML = `<div class="muted">暂无记录</div>`;
        return;
      }

      let tAlloy = 0, tPolish = 0, tScroll = 0, tMoon = 0;

      let html = accList.map(item => {
        tAlloy += item.alloy;
        tPolish += item.polish;
        tScroll += item.scroll;
        tMoon  += item.moon;

        return `
          <div style="margin-bottom:10px;">
            区间：${item.startName} → ${item.endName}
            （× ${item.count}）<br>
            合金 <b>${item.alloy}</b>｜
            抛光 <b>${item.polish}</b>｜
            卷轴 <b>${item.scroll}</b>｜
            月光石 <b>${item.moon}</b>
          </div>
        `;
      }).join('');

      html += `
        <hr style="border-color:var(--border); margin:10px 0;">
        <div>
          <b>总计：</b>
          合金 ${tAlloy}｜抛光 ${tPolish}｜卷轴 ${tScroll}｜月光石 ${tMoon}
        </div>
      `;

      box.innerHTML = html;
    }

    /* 添加区间 */
    document.querySelector('#acc-add').onclick = function () {
      const s = parseInt(accStart.value);
      const e = parseInt(accEnd.value);
      const c = Math.max(1, parseInt(document.querySelector('#acc-count').value));

      if (e < s) {
        alert("最终编号不能小于起始编号！");
        return;
      }

      let alloy=0, polish=0, scroll=0, moon=0;

      for (const r of rows) {
        if (r.id > s && r.id <= e) {
          alloy  += r.alloy;
          polish += r.polish;
          scroll += r.scroll;
          moon   += r.moon;
        }
      }

      alloy  *= c;
      polish *= c;
      scroll *= c;
      moon   *= c;

      accList.push({ start:s, end:e, startName: rows.find(r => r.id === s).tier, endName: rows.find(r => r.id === e).tier, count:c, alloy, polish, scroll, moon });
      renderAccList();
    };

    /* 清空所有区间 */
    document.querySelector('#acc-clear').onclick = function () {
      accList = [];
      renderAccList();
    };
  </script>
</body>
</html>
